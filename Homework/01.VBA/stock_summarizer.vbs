' LoopWorksheet() function copied from MohammadSub LoopWorksheet()    Dim xSh As Worksheet    Application.ScreenUpdating = False    For Each xSh In Worksheets        xSh.Select        Call RunCode    Next    Application.ScreenUpdating = TrueEnd SubSub RunCode()    ' Initialize variables    Dim row_num As Long    Dim first_ticker_row As Long    Dim last_ticker_row As Long    Dim summary_row As Long        row_num = Cells(Rows.Count, 1).End(xlUp).Row    first_ticker_row = 2    summary_row = 2        ' Set summary table column names    Cells(1, 9).Value = "Ticker"    Cells(1, 10).Value = "Yearly Change"    Cells(1, 11).Value = "Percent Change"    Cells(1, 12).Value = "Total Volume"        For last_ticker_row = 2 To row_num        If Cells(last_ticker_row, 1).Value <> Cells(last_ticker_row + 1, 1).Value Then            ' Update summary values            Cells(summary_row, 9).Value = Cells(last_ticker_row, 1).Value            Cells(summary_row, 10).Value = Cells(last_ticker_row, 6).Value - Cells(first_ticker_row, 3).Value            If Cells(first_ticker_row, 3).Value <> 0 Then            Cells(summary_row, 11).Value = Cells(summary_row, 10).Value / Cells(first_ticker_row, 3).Value            Else                Cells(summary_row, 11).Value = 0            End If            Cells(summary_row, 11).NumberFormat = "0.00%"            Cells(summary_row, 12).Value = Application.WorksheetFunction.Sum(Range(Cells(first_ticker_row, 7), Cells(last_ticker_row, 7)))                        ' Format color of yearly change cell            If Cells(summary_row, 10) < 0 Then                Cells(summary_row, 10).Interior.ColorIndex = 3            Else                Cells(summary_row, 10).Interior.ColorIndex = 4            End If                        ' Update summary row and first ticker row            summary_row = summary_row + 1            first_ticker_row = last_ticker_row + 1                    End If    Next last_ticker_row        ' Bonus ---------------------------------------------    Dim summary_row_num As Long    Dim max_percent_row As Long    Dim min_percent_row As Long    Dim max_volume_row As Long    summary_row_num = Cells(Rows.Count, 9).End(xlUp).Row        ' Set bonus summary table header    Cells(1, 16).Value = "Ticker"    Cells(1, 17).Value = "Value"    Cells(2, 15).Value = "Greatest % Increase"    Cells(3, 15).Value = "Greatest % Decrease"    Cells(4, 15).Value = "Greatest Total Volume"        ' Identify rows of interest    max_percent_row = Application.WorksheetFunction.Match(Application.WorksheetFunction.Max(Range(Cells(2, 11), Cells(summary_row_num, 11))), Range(Cells(2, 11), Cells(summary_row_num, 11)), 0) + 1    min_percent_row = Application.WorksheetFunction.Match(Application.WorksheetFunction.Min(Range(Cells(2, 11), Cells(summary_row_num, 11))), Range(Cells(2, 11), Cells(summary_row_num, 11)), 0) + 1    max_volume_row = Application.WorksheetFunction.Match(Application.WorksheetFunction.Max(Range(Cells(2, 12), Cells(summary_row_num, 12))), Range(Cells(2, 12), Cells(summary_row_num, 12)), 0) + 1    ' Assign values to bonus summary    Range("P2").Value = Cells(max_percent_row, 9)    Range("Q2").Value = FormatPercent(Cells(max_percent_row, 11))    Range("P3").Value = Cells(min_percent_row, 9)    Range("Q3").Value = FormatPercent(Cells(min_percent_row, 11))    Range("P4").Value = Cells(max_volume_row, 9)    Range("Q4").Value = Cells(max_volume_row, 12)End Sub